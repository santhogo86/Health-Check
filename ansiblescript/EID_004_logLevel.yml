- name: Execute Log Level Config Status Check Command
  shell: kubectl exec {{ pod_name }} -n {{ namespace }} -- {{ EID_004_CMD }}
  register: cmdOutput
  ignore_errors: yes

- name: Display command output
  debug:
    msg: "Command output: {{ cmdOutput.stdout | default('No output in check mode') }}"

- name: Check if CLI command worked
  set_fact:
    cli_working: "{{ 'PASS' if (cmdOutput.rc == 0 and cmdOutput.stdout | length > 0) else 'FAIL' }}"

- name: Check for DEBUG log level
  set_fact:
    debug_level_check: "{{ 'PASS' if 'DEBUG' not in (cmdOutput.stdout | default('')) else 'FAIL' }}"

- name: Determine final result
  set_fact:
    final_result: "{{ 'PASS' if (cli_working == 'PASS' and debug_level_check == 'PASS') else 'FAIL' }}"

- name: Result
  debug:
    msg: "{{ final_result }} - CLI Working: {{ cli_working }}, DEBUG Level Check: {{ debug_level_check }}"

- name: Set final result for EID_004
  set_fact:
    eid_004_final_result: "{{ final_result }}"
